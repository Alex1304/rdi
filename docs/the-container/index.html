<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-the-container" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">The Container | RDI Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://alex1304.github.io/rdi/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://alex1304.github.io/rdi/img/logo.png"><meta data-rh="true" property="og:url" content="https://alex1304.github.io/rdi/docs/the-container"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="The Container | RDI Documentation"><meta data-rh="true" name="description" content="Once you have all your service descriptors set up, it is time to create the most important object in your application: the container."><meta data-rh="true" property="og:description" content="Once you have all your service descriptors set up, it is time to create the most important object in your application: the container."><link data-rh="true" rel="icon" href="/rdi/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://alex1304.github.io/rdi/docs/the-container"><link data-rh="true" rel="alternate" href="https://alex1304.github.io/rdi/docs/the-container" hreflang="en"><link data-rh="true" rel="alternate" href="https://alex1304.github.io/rdi/docs/the-container" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"The Container","item":"https://alex1304.github.io/rdi/docs/the-container"}]}</script><script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/rdi/assets/css/styles.68e608d0.css">
<script src="/rdi/assets/js/runtime~main.51cbe7b5.js" defer="defer"></script>
<script src="/rdi/assets/js/main.4269c33b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_rPjb" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rdi/"><div class="navbar__logo"><img src="/rdi/img/logo.png" alt="" class="themedComponent_gegH themedComponent--light_DETN"><img src="/rdi/img/logo.png" alt="" class="themedComponent_gegH themedComponent--dark_r4DQ"></div><b class="navbar__title text--truncate">RDI Documentation</b></a><a class="navbar__item navbar__link" href="/rdi/docs/intro">Docs</a><a href="https://www.javadoc.io/doc/com.github.alex1304/rdi/latest/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_PHbF"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_kkmW colorModeToggle_zsNT"><button class="clean-btn toggleButton_TjTN toggleButtonDisabled_V5P9" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_kE6a lightToggleIcon_ruGK"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_kE6a darkToggleIcon_bx73"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_kE6a systemToggleIcon_R5zt"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_AD9z"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_QIaM"><div class="docsWrapper_djjy"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Fh6Z" type="button"></button><div class="docRoot_HW0i"><aside class="theme-doc-sidebar-container docSidebarContainer_XB98"><div class="sidebarViewport_pMdH"><div class="sidebar_BR52"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_xeN1"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_bhuW menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rdi/docs/intro"><span title="Discover RDI" class="categoryLinkLabel_iPtR">Discover RDI</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_bhuW menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/rdi/docs/service-references"><span title="Core features" class="categoryLinkLabel_iPtR">Core features</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rdi/docs/service-references"><span title="Service References" class="linkLabel_vtlO">Service References</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rdi/docs/service-descriptors"><span title="Service Descriptors" class="linkLabel_vtlO">Service Descriptors</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rdi/docs/the-container"><span title="The Container" class="linkLabel_vtlO">The Container</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_bhuW menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rdi/docs/annotation-based-configuration"><span title="Advanced" class="categoryLinkLabel_iPtR">Advanced</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_ZhoE"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_dvZG"><div class="docItemContainer_shg0"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_vkdb" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rdi/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_TAkf"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core features</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">The Container</span></li></ul></nav><div class="tocCollapsible_R51T theme-doc-toc-mobile tocMobile_uqzo"><button type="button" class="clean-btn tocCollapsibleButton_AyNr">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>The Container</h1></header><p>Once you have all your <a class="" href="/rdi/docs/service-descriptors">service descriptors</a> set up, it is time to create the most important object in your application: the container.</p>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="the-rdiconfig-class">The <code>RdiConfig</code> class<a href="#the-rdiconfig-class" class="hash-link" aria-label="Direct link to the-rdiconfig-class" title="Direct link to the-rdiconfig-class" translate="no">​</a></h2>
<p>To pass your service descriptors to the container, you have to do it via the <code>RdiConfig</code> class. <code>RdiConfig</code> is nothing more than a wrapper around a <code>Set&lt;ServiceDescriptor&gt;</code>. The difference is that it only has a &quot;add&quot; method, and it will throw an exception if you add two service descriptors that targets the same service reference.</p>
<p>To create a <code>RdiConfig</code> you simply need to create a builder and call <code>registerService</code> for each descriptor:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RdiConfig config = RdiConfig.builder()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .registerService(descriptor1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .registerService(descriptor2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="creating-the-container">Creating the container<a href="#creating-the-container" class="hash-link" aria-label="Direct link to Creating the container" title="Direct link to Creating the container" translate="no">​</a></h2>
<p>The container is represented by the <code>RdiServiceContainer</code> interface. Since this is a public interface, any third party may provide a custom implementation, but the library comes with a built-in one accessible via <code>RdiServiceContainer#create(RdiConfig)</code>.</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RdiServiceContainer container = RdiServiceContainer.create(config);</span><br></span></code></pre></div></div>
<p>When calling <code>create</code>, a lot of things are happening behind the scenes. Even if it may change from an implementation to another, the creation of a container goes through the following steps:</p>
<ol>
<li class="">The descriptors in the config are read, and a dependency graph is constructed.</li>
<li class="">With that dependency graph, it will detect any cycles in the factory methods of the services, throwing an exception and interrupting everything if the check fails.</li>
<li class="">The reactive chains to instantiate services and their dependencies will be assembled. The cache for singletons will be prepared.</li>
<li class="">A mapping between service references and the newly created reactive chains will be established</li>
<li class="">The container is created with that mapping info stored internally, in a way or another.</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="using-the-container">Using the container<a href="#using-the-container" class="hash-link" aria-label="Direct link to Using the container" title="Direct link to Using the container" translate="no">​</a></h2>
<p>Once your container is created, you can use it to request service instances. That is done via the <code>RdiServiceContainer#getService(ServiceReference)</code> method:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Somewhere defined as constant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public static final ServiceReference&lt;A&gt; A_REF = ServiceReference.ofType(A.class);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mono&lt;A&gt; monoA = container.getService(A_REF);</span><br></span></code></pre></div></div>
<p>In order to get the actual instance of A, you need to integrate that mono in your own reactive chain, or block on it if you do not want to use the reactive features. If you are reading this document you are most probably in the former case, so you will probably want something like this:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">monoA.subscribe(a -&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Do something with A, or use an intermediate operator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // such as flatMap to let it flow downstream.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span></code></pre></div></div>
<p>It is important to note that <strong>nothing will happen until the returned Mono is subscribed to</strong>. The dependency injection is performed only at subscription time. If you didn&#x27;t get any errors when creating the config, it is unlikely that your Mono will error, unless a constructor or a setter explicitly throws an exception or a circular instantiation is detected, as explained in the previous page.</p>
<blockquote>
<p>If your service hierarchy is well designed, you should resort to the <code>getService</code> method only once in your application. If you define one root service that depends on all others, you should be able to access all other services via the injections.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="singleton-thread-safety">Singleton thread safety<a href="#singleton-thread-safety" class="hash-link" aria-label="Direct link to Singleton thread safety" title="Direct link to Singleton thread safety" translate="no">​</a></h2>
<p>Subscribing to the <code>Mono</code> returned by <code>getService</code> may be done by multiple threads. The default implementation is fully thread-safe, a singleton service is guaranteed to be instantiated once and only once.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_waP3"></div><div class="col lastUpdated_gl8L"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2020-08-05T22:38:23.000Z" itemprop="dateModified">Aug 5, 2020</time></b> by <b>Alex1304</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rdi/docs/service-descriptors"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Service Descriptors</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rdi/docs/annotation-based-configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Annotation-based Configuration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_ysE5 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-rdiconfig-class" class="table-of-contents__link toc-highlight">The <code>RdiConfig</code> class</a></li><li><a href="#creating-the-container" class="table-of-contents__link toc-highlight">Creating the container</a></li><li><a href="#using-the-container" class="table-of-contents__link toc-highlight">Using the container</a></li><li><a href="#singleton-thread-safety" class="table-of-contents__link toc-highlight">Singleton thread safety</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Alex1304 - Made with Docusaurus</div></div></div></footer></div>
</body>
</html>