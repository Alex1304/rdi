<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-service-descriptors" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Service Descriptors | RDI Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://alex1304.github.io/rdi/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://alex1304.github.io/rdi/img/logo.png"><meta data-rh="true" property="og:url" content="https://alex1304.github.io/rdi/docs/service-descriptors"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Service Descriptors | RDI Documentation"><meta data-rh="true" name="description" content="A service descriptor is what allows to define the dependencies to inject in a specific service. A service descriptor may only apply to a single service reference. If you want to define more than one way to instantiate a class, you are supposed to create as many service references with the same type and with a different name to distinguish them."><meta data-rh="true" property="og:description" content="A service descriptor is what allows to define the dependencies to inject in a specific service. A service descriptor may only apply to a single service reference. If you want to define more than one way to instantiate a class, you are supposed to create as many service references with the same type and with a different name to distinguish them."><link data-rh="true" rel="icon" href="/rdi/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://alex1304.github.io/rdi/docs/service-descriptors"><link data-rh="true" rel="alternate" href="https://alex1304.github.io/rdi/docs/service-descriptors" hreflang="en"><link data-rh="true" rel="alternate" href="https://alex1304.github.io/rdi/docs/service-descriptors" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Service Descriptors","item":"https://alex1304.github.io/rdi/docs/service-descriptors"}]}</script><script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/rdi/assets/css/styles.68e608d0.css">
<script src="/rdi/assets/js/runtime~main.51cbe7b5.js" defer="defer"></script>
<script src="/rdi/assets/js/main.4269c33b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_rPjb" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rdi/"><div class="navbar__logo"><img src="/rdi/img/logo.png" alt="" class="themedComponent_gegH themedComponent--light_DETN"><img src="/rdi/img/logo.png" alt="" class="themedComponent_gegH themedComponent--dark_r4DQ"></div><b class="navbar__title text--truncate">RDI Documentation</b></a><a class="navbar__item navbar__link" href="/rdi/docs/intro">Docs</a><a href="https://www.javadoc.io/doc/com.github.alex1304/rdi/latest/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_PHbF"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_kkmW colorModeToggle_zsNT"><button class="clean-btn toggleButton_TjTN toggleButtonDisabled_V5P9" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_kE6a lightToggleIcon_ruGK"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_kE6a darkToggleIcon_bx73"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_kE6a systemToggleIcon_R5zt"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_AD9z"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_QIaM"><div class="docsWrapper_djjy"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Fh6Z" type="button"></button><div class="docRoot_HW0i"><aside class="theme-doc-sidebar-container docSidebarContainer_XB98"><div class="sidebarViewport_pMdH"><div class="sidebar_BR52"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_xeN1"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_bhuW menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rdi/docs/intro"><span title="Discover RDI" class="categoryLinkLabel_iPtR">Discover RDI</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_bhuW menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/rdi/docs/service-references"><span title="Core features" class="categoryLinkLabel_iPtR">Core features</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rdi/docs/service-references"><span title="Service References" class="linkLabel_vtlO">Service References</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rdi/docs/service-descriptors"><span title="Service Descriptors" class="linkLabel_vtlO">Service Descriptors</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rdi/docs/the-container"><span title="The Container" class="linkLabel_vtlO">The Container</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_bhuW menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rdi/docs/annotation-based-configuration"><span title="Advanced" class="categoryLinkLabel_iPtR">Advanced</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_ZhoE"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_dvZG"><div class="docItemContainer_shg0"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_vkdb" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rdi/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_TAkf"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core features</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Service Descriptors</span></li></ul></nav><div class="tocCollapsible_R51T theme-doc-toc-mobile tocMobile_uqzo"><button type="button" class="clean-btn tocCollapsibleButton_AyNr">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Service Descriptors</h1></header><p>A <strong>service descriptor</strong> is what allows to define the dependencies to inject in a specific service. A service descriptor may only apply to a single <a class="" href="/rdi/docs/service-references">service reference</a>. If you want to define more than one way to instantiate a class, you are supposed to create as many service references with the same type and with a different name to distinguish them.</p>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="the-injectable-interface">The <code>Injectable</code> interface<a href="#the-injectable-interface" class="hash-link" aria-label="Direct link to the-injectable-interface" title="Direct link to the-injectable-interface" translate="no">​</a></h2>
<p>The <code>Injectable</code> interface is typically used to represent a dependency to inject. It may be a reference to another service, but it can also be a value which is known in advance.</p>
<h3 class="anchor anchorTargetStickyNavbar_ZQ94" id="injecting-another-service">Injecting another service<a href="#injecting-another-service" class="hash-link" aria-label="Direct link to Injecting another service" title="Direct link to Injecting another service" translate="no">​</a></h3>
<p>This is what you will use most of the time. Injecting another service is done via <code>Injectable#ref(ServiceReference)</code>:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ServiceReference&lt;A&gt; ref = ServiceReference.ofType(A.class);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Injectable toInject = Injectable.ref(ref);</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Important</strong>: The other service must be registered in the container as well. Injecting a reference to a service that is not registered will cause an exception upon creating the container.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_ZQ94" id="injecting-values-known-in-advance">Injecting values known in advance<a href="#injecting-values-known-in-advance" class="hash-link" aria-label="Direct link to Injecting values known in advance" title="Direct link to Injecting values known in advance" translate="no">​</a></h3>
<p>If you need to fill a constructor parameter or a setter with a value known in advance, you can use <code>Injectable#value(...)</code> (overloads exist for object and primitive types):</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">int x = 1304;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Injectable toInject = Injectable.value(x);</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="defining-dependencies">Defining dependencies<a href="#defining-dependencies" class="hash-link" aria-label="Direct link to Defining dependencies" title="Direct link to Defining dependencies" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_ZQ94" id="constructor-dependencies">Constructor dependencies<a href="#constructor-dependencies" class="hash-link" aria-label="Direct link to Constructor dependencies" title="Direct link to Constructor dependencies" translate="no">​</a></h3>
<p>Defining dependencies in a constructor is done with <code>FactoryMethod#constructor(Injectable...)</code>. Given the following constructor:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class C {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public C(D d, int value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        this.d = d;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        this.value = value;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>The corresponding service descriptor would be the following (<code>C_REF</code> and <code>D_REF</code> being service references to C and D respectively, assuming they are defined as constants):</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ServiceDescriptor descriptor = ServiceDescriptor.builder(C_REF)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .setFactoryMethod(FactoryMethod.constructor(Injectable.ref(D_REF), Injectable.value(123456)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Tip:</strong> For better code readability, it is recommended to use static imports for <code>FactoryMethod</code> and <code>Injectable</code> static methods:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import static com.github.alex1304.rdi.config.FactoryMethod.*;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import static com.github.alex1304.rdi.config.Injectable.*;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ServiceDescriptor descriptor = ServiceDescriptor.builder(C_REF)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .setFactoryMethod(constructor(ref(D_REF), value(123456)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span></code></pre></div></div>
<p>Code examples in this document will make use of static imports going forward.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_ZQ94" id="static-factory-dependencies">Static factory dependencies<a href="#static-factory-dependencies" class="hash-link" aria-label="Direct link to Static factory dependencies" title="Direct link to Static factory dependencies" translate="no">​</a></h3>
<p>Static factories work the same way as constructors, except that they have a name and a return type. Below is an example static factory and the corresponding service descriptor:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class E {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public static E create(F f, long value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return new E(f, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ServiceDescriptor descriptor = ServiceDescriptor.builder(E_REF)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .setFactoryMethod(staticFactory(&quot;create&quot;, E.class, ref(F_REF), value(1200L)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note:</strong> Static factories might as well be located in a different class than the service itself, for example in an utility class. In that case, use <code>FactoryMethod#externalStaticFactory</code> instead which takes the owner class as first argument, the other arguments are the same as for the regular <code>staticFactory</code>.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_ZQ94" id="setter-dependencies">Setter dependencies<a href="#setter-dependencies" class="hash-link" aria-label="Direct link to Setter dependencies" title="Direct link to Setter dependencies" translate="no">​</a></h3>
<p>RDI also supports injection via setters. Useful for mutable classes, it works as follows:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class G {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void setH(H h) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        this.h = h;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void setCount(int count) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        this.count = count;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ServiceDescriptor descriptor = ServiceDescriptor.builder(G_REF)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .addSetterMethod(&quot;setH&quot;, ref(H_REF))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .addSetterMethod(&quot;setCount&quot;, value(1234))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span></code></pre></div></div>
<p>Unlike constructors and factories, you cannot inject more than 1 dependency per setter, but you can add as many setters as you want. You may even specify the same setter multiple times, useful if the setter performs a &quot;add&quot; operation.</p>
<blockquote>
<p><strong>Note:</strong> if the return type of the setter is not <code>void</code>, which is typically the case for objects that return themselves for chaining purposes, there is an overload that takes the return type as last argument.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="considerations-regarding-method-lookup">Considerations regarding method lookup<a href="#considerations-regarding-method-lookup" class="hash-link" aria-label="Direct link to Considerations regarding method lookup" title="Direct link to Considerations regarding method lookup" translate="no">​</a></h2>
<p>Because RDI uses the Method Handles API behind the scenes to find the injection methods, there are a few considerations to take into account in order not to be surprised with some exceptions:</p>
<ol>
<li class=""><strong>All injection methods must be public</strong>. This is a requirement to always follow, otherwise the <code>build()</code> method on <code>ServiceDescriptor</code> will throw an exception.</li>
<li class=""><strong>The injectable parameters must have strictly the same type as the target method&#x27;s parameters</strong>. The Method Handles lookup API is sensitive to sub-typing and boxing of types. It means that if the method expects an <code>Object</code>, the <code>Injectable</code> must be an <code>Object</code>. If it expects an <code>int</code>, you cannot specify an <code>Integer</code>. In these cases, you must specify the actual type via <code>Injectable#ref(ServiceReference&lt;T&gt;, Class&lt;? super T&gt;)</code> or <code>Injectable#value(T, Class&lt;? super T&gt;)</code> to tell RDI that it should look for a supertype. Here&#x27;s an example to illustrate:<!-- -->
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class A {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public A(Object o) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        this.o = o;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public A(B b) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        throw new RuntimeException(&quot;Use the other constructor, thanks&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ServiceDescriptor descriptor = ServiceDescriptor.builder(A_REF)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .setFactoryMethod(constructor(ref(B_REF, Object.class))) // Add Object.class to specify that you want the first constructor and not the second</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note:</strong> This is also true for return types of static factories and setters, they must exactly match.</p>
</blockquote>
</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="singletons">Singletons<a href="#singletons" class="hash-link" aria-label="Direct link to Singletons" title="Direct link to Singletons" translate="no">​</a></h2>
<p>The service descriptor builder lets you set whether the service should be a singleton or not. If a service is defined as a singleton, the container will always re-use the same instance when the service is requested or injected. Otherwise, it will always create a new instance and the same instance will never be shared.</p>
<p>By default, all services will be singletons. If you don&#x27;t want a service to be a singleton, you can specify it like this:</p>
<div class="language-java codeBlockContainer_Z2VO theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_CQaz"><pre tabindex="0" class="prism-code language-java codeBlock_Seqb thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ARjV"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ServiceDescriptor descriptor = ServiceDescriptor.builder(ref)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .setSingleton(false)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="circular-dependencies">Circular dependencies<a href="#circular-dependencies" class="hash-link" aria-label="Direct link to Circular dependencies" title="Direct link to Circular dependencies" translate="no">​</a></h2>
<p>If you have let&#x27;s say <code>A</code> that depends on itself, or <code>A</code> that depends on <code>B</code> and <code>B</code> that depends on <code>A</code>, it is called a <strong>circular dependency</strong>. If RDI detects a circular dependency in a constructor or a static factory, an exception will be thrown when <strong>creating the container</strong>. For setters, it is not an issue, as they are invoked <em>after</em> instantiating the object. However, if none of the services involved in the cycle are declared as singleton, it will lead to an exception <strong>at subscription time</strong>, as the container would endlessly create new instance for each service. RDI is able to detect that and throw an exception before it turns into an <code>OutOfMemoryError</code>, but keep in mind it can only be detected at subscription time. To avoid the issue, declare your services as singleton whenever possible (which should already be by default), or find an alternative to remove the cycle.</p>
<h2 class="anchor anchorTargetStickyNavbar_ZQ94" id="convenience-methods">Convenience methods<a href="#convenience-methods" class="hash-link" aria-label="Direct link to Convenience methods" title="Direct link to Convenience methods" translate="no">​</a></h2>
<p>The <code>ServiceDescriptor</code> has a few convenience methods to create a new service descriptor for common scenarios. The first one is if your service does not require any dependency. In this situation you can use <code>ServiceDescriptor#standalone(ServiceReference)</code> to create the descriptor directly without using a builder. The <code>standalone</code> method exists in another variant with a <code>boolean</code> as second argument if you want it not to be a singleton.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_waP3"></div><div class="col lastUpdated_gl8L"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2020-07-29T22:29:57.000Z" itemprop="dateModified">Jul 29, 2020</time></b> by <b>Alex1304</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rdi/docs/service-references"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Service References</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rdi/docs/the-container"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">The Container</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_ysE5 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-injectable-interface" class="table-of-contents__link toc-highlight">The <code>Injectable</code> interface</a><ul><li><a href="#injecting-another-service" class="table-of-contents__link toc-highlight">Injecting another service</a></li><li><a href="#injecting-values-known-in-advance" class="table-of-contents__link toc-highlight">Injecting values known in advance</a></li></ul></li><li><a href="#defining-dependencies" class="table-of-contents__link toc-highlight">Defining dependencies</a><ul><li><a href="#constructor-dependencies" class="table-of-contents__link toc-highlight">Constructor dependencies</a></li><li><a href="#static-factory-dependencies" class="table-of-contents__link toc-highlight">Static factory dependencies</a></li><li><a href="#setter-dependencies" class="table-of-contents__link toc-highlight">Setter dependencies</a></li></ul></li><li><a href="#considerations-regarding-method-lookup" class="table-of-contents__link toc-highlight">Considerations regarding method lookup</a></li><li><a href="#singletons" class="table-of-contents__link toc-highlight">Singletons</a></li><li><a href="#circular-dependencies" class="table-of-contents__link toc-highlight">Circular dependencies</a></li><li><a href="#convenience-methods" class="table-of-contents__link toc-highlight">Convenience methods</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Alex1304 - Made with Docusaurus</div></div></div></footer></div>
</body>
</html>