<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Dynamic Configuration · RDI Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="So far we have been defining the RDI configuration directly in the Java code. In this section we will see how it is possible to build the configuration dynamically, to make it more flexible and fit more use cases."/><meta name="docsearch:version" content="1.0.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Dynamic Configuration · RDI Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://alex1304.github.io/rdi/"/><meta property="og:description" content="So far we have been defining the RDI configuration directly in the Java code. In this section we will see how it is possible to build the configuration dynamically, to make it more flexible and fit more use cases."/><meta property="og:image" content="https://alex1304.github.io/rdi/img/logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://alex1304.github.io/rdi/img/logo.png"/><link rel="shortcut icon" href="/rdi/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/darcula.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/rdi/js/scrollSpy.js"></script><link rel="stylesheet" href="/rdi/css/main.css"/><script src="/rdi/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/rdi/"><img class="logo" src="/rdi/img/logo.png" alt="RDI Documentation"/><h2 class="headerTitleWithLogo">RDI Documentation</h2></a><a href="/rdi/versions"><h3>1.0.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/rdi/docs/1.0.1/intro" target="_self">Docs</a></li><li class=""><a href="https://www.javadoc.io/doc/com.github.alex1304/rdi/latest/index.html" target="_self">API</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Advanced</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Discover RDI</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rdi/docs/1.0.1/intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/rdi/docs/1.0.1/getting-started">Getting Started</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Core features</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rdi/docs/1.0.1/service-references">Service References</a></li><li class="navListItem"><a class="navItem" href="/rdi/docs/1.0.1/service-descriptors">Service Descriptors</a></li><li class="navListItem"><a class="navItem" href="/rdi/docs/1.0.1/the-container">The Container</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rdi/docs/1.0.1/debugging">Debugging</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/rdi/docs/1.0.1/dynamic-configuration">Dynamic Configuration</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Dynamic Configuration</h1></header><article><div><span><p>So far we have been defining the RDI configuration directly in the Java code. In this section we will see how it is possible to build the configuration dynamically, to make it more flexible and fit more use cases.</p>
<h2><a class="anchor" aria-hidden="true" id="building-the-configuration-using-a-description-language"></a><a href="#building-the-configuration-using-a-description-language" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building the configuration using a description language</h2>
<p>The <code>RdiConfig</code> class is instantiated using a builder pattern, meaning that there is an intermediate mutable object that is mutated step-by-step until the configuration is complete and the <code>build()</code> method is called. This approach paves the way for the use of description languages to perform this step-by-step build, to save even more time when configuring services.</p>
<p>Other dependency injection frameworks do that, with Spring you can declare your beans in <strong>XML files</strong> as well as via <strong>Java annotations</strong>.</p>
<p>Unfortunately, RDI does not yet natively provide a way to achieve configuration with such description languages, but it is worth to mention it here because the builder pattern really can pave the way for many possibilities.</p>
<h2><a class="anchor" aria-hidden="true" id="building-the-configuration-in-a-multi-moduleplugin-project"></a><a href="#building-the-configuration-in-a-multi-moduleplugin-project" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building the configuration in a multi module/plugin project</h2>
<p>If there is one thing that is already possible to do however, it's the ability to declare service descriptors in different modules (which may even be in different JARs), and collect all of them in your main module where the container is supposed to live. You can do that by exposing an interface that would look like this:</p>
<pre><code class="hljs css language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ServiceDescriptorProvider</span> </span>{

    <span class="hljs-function">ServiceDescriptor <span class="hljs-title">provide</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// you may as well put some sort of Context class as parameter, as you see fit</span>
}
</code></pre>
<p>In your different JARs you can give various implementations of this interface, and declare them as a service by creating a file in the <code>/META-INF/services/</code> folder of your JAR:</p>
<pre><code class="hljs">META-INF/
   <span class="hljs-params">|
   |</span>_<span class="hljs-number">_</span> services/
          <span class="hljs-params">|
          |</span>_<span class="hljs-number">_</span> com.myapp.ServiceDescriptorProvider
</code></pre>
<p>with <code>com.myapp.ServiceDescriptorProvider</code> being a new file named after the fully qualified name of the interface above, with the following contents:</p>
<pre><code class="hljs"><span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.myapp</span><span class="hljs-selector-class">.MyServiceDescriptorProvider</span>
</code></pre>
<p>which corresponds to the fully qualified name of the implementation class.</p>
<p>Once you have this configured you may use <code>ServiceLoader</code> in your main module and assemble the configuration:</p>
<pre><code class="hljs css language-java">RdiConfig.Builder builder = RdiConfig.builder();
<span class="hljs-keyword">for</span> (ServiceDescriptorProvider provider : ServiceLoader.load(ServiceDescriptorProvider<span class="hljs-class">.<span class="hljs-keyword">class</span>)) </span>{
    builder.registerService(provider.provide());
}
RdiConfig config = builder.build();
</code></pre>
<blockquote>
<p><strong>Note:</strong> This method is outdated since Java 9 with the introduction of Java modules. Instead of exporting services via the <code>/META-INF/services/</code> directory, they are declared in the module-info.java with <code>provides</code> and <code>uses</code> directives. Learn more about it <a href="https://blog.frankel.ch/migrating-serviceloader-java-9-module-system/">here</a>.</p>
</blockquote>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 2020-7-30</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/rdi/docs/1.0.1/debugging"><span class="arrow-prev">← </span><span>Debugging</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#building-the-configuration-using-a-description-language">Building the configuration using a description language</a></li><li><a href="#building-the-configuration-in-a-multi-moduleplugin-project">Building the configuration in a multi module/plugin project</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/rdi/" class="nav-home"><img src="/rdi/img/logo.png" alt="RDI Documentation"/></a><div><h5>Docs</h5><a href="/rdi/docs/en/intro">Introduction</a><a href="https://www.javadoc.io/doc/com.github.alex1304/rdi/latest/index.html">API reference (javadoc)</a></div><div><h5>More</h5><a href="https://github.com/Alex1304/rdi">GitHub</a><a class="github-button" href="https://github.com/Alex1304/rdi" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2020 Alex1304 - Made with Docusaurus</section></footer></div></body></html>